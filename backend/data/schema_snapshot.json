{
  "version": "2.0.0",
  "generated_at": "2025-12-25T13:31:39.492745Z",
  "source": "refresh_schema.py",
  "tables": {
    "orders": {
      "description": "Ordenes de MercadoLibre - tabla principal de ventas",
      "columns": {
        "id": "bigint",
        "buyer_id": "bigint",
        "order_ids": "unknown",
        "status": "text",
        "total_amount": "numeric",
        "currency": "text",
        "date_created": "unknown",
        "date_closed": "unknown",
        "shipping_id": "unknown",
        "shipping_status": "text",
        "shipping_logistic_type": "unknown",
        "date_delivered": "unknown",
        "has_mediation": "boolean",
        "has_fiscal_document": "boolean",
        "fiscal_document_count": "bigint",
        "created_at": "text",
        "updated_at": "text"
      },
      "key_queries": [
        "ventas",
        "ordenes",
        "facturacion",
        "ingresos",
        "pedidos"
      ]
    },
    "order_items": {
      "description": "Items de cada orden - detalle de productos vendidos",
      "columns": {},
      "key_queries": [
        "productos vendidos",
        "items",
        "unidades",
        "detalle"
      ]
    },
    "buyers": {
      "description": "Compradores/clientes de MercadoLibre",
      "columns": {
        "id": "bigint",
        "nickname": "text",
        "first_name": "text",
        "last_name": "text",
        "email": "text",
        "doc_type": "unknown",
        "doc_number": "unknown",
        "taxpayer_type": "unknown",
        "can_receive_factura_a": "boolean",
        "city": "unknown",
        "state": "unknown",
        "country": "text",
        "created_at": "text",
        "updated_at": "text"
      },
      "key_queries": [
        "clientes",
        "compradores",
        "usuarios"
      ]
    },
    "agent_interactions": {
      "description": "Interacciones del agente AI con compradores",
      "columns": {
        "id": "text",
        "buyer_id": "text",
        "buyer_nickname": "text",
        "buyer_name": "unknown",
        "pack_id": "text",
        "order_id": "text",
        "message_original": "text",
        "ai_response": "text",
        "case_type": "text",
        "was_escalated": "boolean",
        "escalation_reason": "unknown",
        "source": "text",
        "was_sent_to_ml": "boolean",
        "ml_response_status": "unknown",
        "n8n_execution_id": "unknown",
        "workflow_id": "text",
        "created_at": "text",
        "product_id": "unknown",
        "product_title": "unknown",
        "product_sku": "unknown",
        "product_price": "unknown",
        "envio_status": "unknown",
        "order_total_amount": "unknown"
      },
      "key_queries": [
        "interacciones",
        "agente AI",
        "mensajes",
        "casos"
      ]
    },
    "escalations": {
      "description": "Casos escalados a humanos para revisión",
      "columns": {
        "id": "text",
        "buyer_id": "text",
        "buyer_nickname": "text",
        "buyer_name": "text",
        "pack_id": "text",
        "order_id": "text",
        "message_original": "text",
        "reason": "text",
        "case_type": "text",
        "source": "text",
        "status": "text",
        "priority": "bigint",
        "assigned_to": "unknown",
        "human_response": "unknown",
        "resolved_at": "unknown",
        "resolution_notes": "unknown",
        "n8n_execution_id": "unknown",
        "workflow_id": "unknown",
        "created_at": "text",
        "updated_at": "text"
      },
      "key_queries": [
        "escalados",
        "escalaciones",
        "soporte",
        "pendientes"
      ]
    },
    "conversations": {
      "description": "Hilos de conversación con clientes",
      "columns": {
        "id": "text",
        "pack_id": "bigint",
        "buyer_id": "bigint",
        "resource_id": "unknown",
        "status": "text",
        "case_type": "text",
        "priority": "bigint",
        "assigned_to": "unknown",
        "ai_confidence": "unknown",
        "requires_human": "boolean",
        "first_message_at": "text",
        "last_message_at": "text",
        "resolved_at": "text",
        "resolution_time_seconds": "bigint",
        "created_at": "text",
        "updated_at": "text",
        "source": "text"
      },
      "key_queries": [
        "conversaciones",
        "chats",
        "hilos"
      ]
    },
    "ml_items": {
      "description": "Productos de MercadoLibre (items)",
      "columns": {
        "item_id": "text",
        "title": "text",
        "permalink": "text",
        "thumbnail": "text",
        "price": "bigint",
        "available_quantity": "bigint",
        "status": "text",
        "sku": "text",
        "category_id": "text",
        "seller_id": "text",
        "created_at": "text",
        "updated_at": "text",
        "total_sold": "bigint",
        "last_synced": "text"
      },
      "key_queries": [
        "productos ML",
        "publicaciones"
      ]
    },
    "ml_orders": {
      "description": "Ordenes de MercadoLibre (packs)",
      "columns": {
        "id": "text",
        "order_id": "bigint",
        "pack_id": "unknown",
        "buyer_id": "bigint",
        "buyer_nickname": "text",
        "item_id": "text",
        "item_title": "text",
        "item_sku": "text",
        "quantity": "bigint",
        "unit_price": "numeric",
        "total_amount": "numeric",
        "shipping_id": "bigint",
        "shipping_status": "unknown",
        "shipping_type": "unknown",
        "date_shipped": "unknown",
        "date_delivered": "unknown",
        "status": "text",
        "date_created": "text",
        "date_closed": "text",
        "raw_data": "unknown",
        "synced_at": "text",
        "created_at": "text",
        "updated_at": "text"
      },
      "key_queries": [
        "ordenes ML",
        "packs"
      ]
    }
  },
  "relationships": [],
  "common_queries": {
    "ventas_totales": "SELECT SUM(total_amount) FROM orders WHERE status = 'paid'",
    "productos_vendidos": "SELECT oi.title, SUM(oi.quantity) as total FROM order_items oi JOIN orders o ON oi.order_id = o.id WHERE o.status = 'paid' GROUP BY oi.title ORDER BY total DESC",
    "stock_bajo": "SELECT id, title, available_quantity FROM products WHERE available_quantity < 10 AND status = 'active'",
    "tasa_escalado": "SELECT COUNT(*) FILTER (WHERE was_escalated) * 100.0 / NULLIF(COUNT(*), 0) FROM agent_interactions"
  }
}